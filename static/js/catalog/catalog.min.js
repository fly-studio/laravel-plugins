/******/ (function(modules) { // webpackBootstrap
/******/ 	// The module cache
/******/ 	var installedModules = {};

/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {

/******/ 		// Check if module is in cache
/******/ 		if(installedModules[moduleId])
/******/ 			return installedModules[moduleId].exports;

/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = installedModules[moduleId] = {
/******/ 			i: moduleId,
/******/ 			l: false,
/******/ 			exports: {}
/******/ 		};

/******/ 		// Execute the module function
/******/ 		modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);

/******/ 		// Flag the module as loaded
/******/ 		module.l = true;

/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}


/******/ 	// expose the modules object (__webpack_modules__)
/******/ 	__webpack_require__.m = modules;

/******/ 	// expose the module cache
/******/ 	__webpack_require__.c = installedModules;

/******/ 	// identity function for calling harmony imports with the correct context
/******/ 	__webpack_require__.i = function(value) { return value; };

/******/ 	// define getter function for harmony exports
/******/ 	__webpack_require__.d = function(exports, name, getter) {
/******/ 		if(!__webpack_require__.o(exports, name)) {
/******/ 			Object.defineProperty(exports, name, {
/******/ 				configurable: false,
/******/ 				enumerable: true,
/******/ 				get: getter
/******/ 			});
/******/ 		}
/******/ 	};

/******/ 	// getDefaultExport function for compatibility with non-harmony modules
/******/ 	__webpack_require__.n = function(module) {
/******/ 		var getter = module && module.__esModule ?
/******/ 			function getDefault() { return module['default']; } :
/******/ 			function getModuleExports() { return module; };
/******/ 		__webpack_require__.d(getter, 'a', getter);
/******/ 		return getter;
/******/ 	};

/******/ 	// Object.prototype.hasOwnProperty.call
/******/ 	__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };

/******/ 	// __webpack_public_path__
/******/ 	__webpack_require__.p = "./";

/******/ 	// Load entry module and return exports
/******/ 	return __webpack_require__(__webpack_require__.s = 5);
/******/ })
/************************************************************************/
/******/ ([
/* 0 */
/***/ (function(module, exports, __webpack_require__) {

Vue.component('catalog-normal', __webpack_require__(1));

Vue.component('catalog-extra-site', __webpack_require__(6));

(function ($) {
	$().ready(function () {
		var catalogForm = new Vue({
			el: '#catalog-form',
			methods: {
				create: function create(pid, tId) {
					this.$refs['catalog-form-container'].create(pid, tId);
				},
				edit: function edit(id, tId) {
					this.$refs['catalog-form-container'].edit(id, tId);
				}
			}
		});

		var $form = $('#form').query();
		$('a[method]').query();

		var method = {},
		    variant = { curDragNodes: null },
		    dom = { lastConnection: null };
		var $zTree = null;
		$('[name="catalog/"]').addClass('active').parents('li').addClass('active');

		method.addHoverDom = function (treeId, treeNode) {
			var sObj = $("#" + treeNode.tId + "_span");
			if (treeNode.editNameFlag || $("#addBtn_" + treeNode.tId).length > 0 || !$zTree.setting.edit.enable) return; //不允许编辑
			//if (treeNode.parentTId) return; //只允许父级
			//console.log(treeNode);
			var addStr = "<span class='button add' id='addBtn_" + treeNode.tId + "' title='添加子项' onfocus='this.blur();'></span>";
			sObj.after(addStr);
			var btn = $("#addBtn_" + treeNode.tId);
			btn.off('click').on("click", function () {
				$zTree.selectNode(treeNode);
				catalogForm.create(treeNode.id, treeNode.tId);
				return false;
			});
		};
		method.removeHoverDom = function (treeId, treeNode) {
			$("#addBtn_" + treeNode.tId).off().remove();
		};
		method.dropPrev = function (treeId, nodes, targetNode) {
			var pNode = targetNode.getParentNode();
			for (var i = 0, l = variant.curDragNodes.length; i < l; i++) {
				var curPNode = variant.curDragNodes[i].getParentNode();
				//不能移出父级
				if (curPNode && curPNode !== targetNode.getParentNode() && curPNode.childOuter === false) {
					return false;
				}
			}
			return true;
		};
		method.dropNext = method.dropPrev;

		method.beforeDrag = function (treeId, treeNodes) {
			for (var i = 0, l = treeNodes.length; i < l; i++) {
				if (treeNodes[i].drag === false) {
					variant.curDragNodes = null;
					return false;
					//不能移出父级
				} else if (treeNodes[i].parentTId && treeNodes[i].getParentNode().childDrag === false) {
					variant.curDragNodes = null;
					return false;
				}
			}
			variant.curDragNodes = treeNodes;
			return true;
		};
		method.beforeDrop = function (treeId, treeNodes, targetNode, moveType) {
			if (!treeNodes.length || !targetNode) return false;
			var node = treeNodes[0];
			if (node.parentTId != targetNode.parentTId) return false; //如果父级不一致

			LP.queryTip('PUT', LP.baseuri + 'admin/catalog/move', { original_id: node.id, target_id: targetNode.id, move_type: moveType }).done(function (json) {
				var src_node = $zTree.getNodeByParam("id", json.data.original_id, null);
				var target_node = $zTree.getNodeByParam("id", json.data.target_id, null);
				$zTree.moveNode(target_node, src_node, json.data.move_type);
			});
			return false; //always false,manual it;
		};
		method.beforeRemove = function (treeId, treeNode) {
			$zTree.selectNode(treeNode);

			$.confirm('<p style="text-align:left;">你<b>确认删除</b>此项：<span style="color:red">[' + treeNode.title + ']</span>，此操作是不可恢復的</p>', function () {
				$.LP.queryTip('DELETE', LP.baseuri + 'admin/catalog/' + treeNode.id);
			});
			return false;
		};
		method.showRemoveBtn = function (treeId, treeNode) {
			return !treeNode.isParent && ~~treeNode.level !== 0; //不是根,也不是父级
		};

		method.onclick = function (event, treeId, treeNode) {
			if (~~treeNode.id !== 0) {
				catalogForm.edit(treeNode.id, treeNode.tId);
			} else catalogForm.create(treeNode.id, treeNode.tId);
		};

		var setting = {
			view: {
				addHoverDom: method.addHoverDom,
				removeHoverDom: method.removeHoverDom,
				selectedMulti: false
			},
			edit: {
				enable: true,
				editNameSelectAll: true,
				removeTitle: '删除此项',
				showRemoveBtn: method.showRemoveBtn,
				showRenameBtn: false,
				drag: {
					isCopy: false,
					autoExpandTrigger: true,
					prev: method.dropPrev,
					inner: false,
					next: method.dropNext
				}
			},
			callback: {
				beforeDrag: method.beforeDrag,
				beforeDrop: method.beforeDrop,
				beforeRemove: method.beforeRemove,
				//beforeRename: method.beforeRename,
				onClick: method.onclick
			},
			data: {
				simpleData: {
					enable: true,
					idKey: "id",
					pIdKey: "pid",
					rootPId: 0
				},
				key: {
					name: 'title'
				}
			}
		};
		$zTree = $.fn.zTree.init($("#tree"), setting, TreeData);
		var node = $zTree.expandAll(true);
		$zTree.selectNode(node);
		$zTree.expandNode(node, true);
	});
})(window.jQuery);

/***/ }),
/* 1 */
/***/ (function(module, exports, __webpack_require__) {

var Component = __webpack_require__(2)(
  /* script */
  __webpack_require__(4),
  /* template */
  __webpack_require__(3),
  /* scopeId */
  null,
  /* cssModules */
  null
)
Component.options.__file = "d:\\Website\\project\\l++\\static\\js\\catalog\\vue\\catalog-normal.vue"
if (Component.esModule && Object.keys(Component.esModule).some(function (key) {return key !== "default" && key !== "__esModule"})) {console.error("named exports are not supported in *.vue files.")}
if (Component.options.functional) {console.error("[vue-loader] catalog-normal.vue: functional components are not supported with templates, they should use render functions.")}

/* hot reload */
if (false) {(function () {
  var hotAPI = require("vue-loader/node_modules/vue-hot-reload-api")
  hotAPI.install(require("vue"), false)
  if (!hotAPI.compatible) return
  module.hot.accept()
  if (!module.hot.data) {
    hotAPI.createRecord("data-v-1e1a2110", Component.options)
  } else {
    hotAPI.reload("data-v-1e1a2110", Component.options)
  }
})()}

module.exports = Component.exports


/***/ }),
/* 2 */
/***/ (function(module, exports) {

module.exports = function normalizeComponent (
  rawScriptExports,
  compiledTemplate,
  scopeId,
  cssModules
) {
  var esModule
  var scriptExports = rawScriptExports = rawScriptExports || {}

  // ES6 modules interop
  var type = typeof rawScriptExports.default
  if (type === 'object' || type === 'function') {
    esModule = rawScriptExports
    scriptExports = rawScriptExports.default
  }

  // Vue.extend constructor export interop
  var options = typeof scriptExports === 'function'
    ? scriptExports.options
    : scriptExports

  // render functions
  if (compiledTemplate) {
    options.render = compiledTemplate.render
    options.staticRenderFns = compiledTemplate.staticRenderFns
  }

  // scopedId
  if (scopeId) {
    options._scopeId = scopeId
  }

  // inject cssModules
  if (cssModules) {
    var computed = options.computed || (options.computed = {})
    Object.keys(cssModules).forEach(function (key) {
      var module = cssModules[key]
      computed[key] = function () { return module }
    })
  }

  return {
    esModule: esModule,
    exports: scriptExports,
    options: options
  }
}


/***/ }),
/* 3 */
/***/ (function(module, exports, __webpack_require__) {

module.exports={render:function (){var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;
  return _c('form', {
    directives: [{
      name: "show",
      rawName: "v-show",
      value: (typeof _vm.node.parent.id != 'undefined'),
      expression: "typeof node.parent.id != 'undefined'"
    }],
    staticClass: "form-horizontal form-bordered",
    attrs: {
      "action": _vm.action,
      "method": "POST",
      "id": "form"
    }
  }, [_c('input', {
    directives: [{
      name: "model",
      rawName: "v-model",
      value: (_vm.csrf),
      expression: "csrf"
    }],
    attrs: {
      "type": "hidden",
      "name": "_token"
    },
    domProps: {
      "value": _vm._s(_vm.csrf)
    },
    on: {
      "input": function($event) {
        if ($event.target.composing) { return; }
        _vm.csrf = $event.target.value
      }
    }
  }), _vm._v(" "), _c('input', {
    attrs: {
      "type": "hidden",
      "name": "_method"
    },
    domProps: {
      "value": _vm.method
    }
  }), _vm._v(" "), _c('div', {
    staticClass: "form-group"
  }, [_c('label', {
    staticClass: "col-sm-2 control-label",
    attrs: {
      "for": "name"
    }
  }, [_vm._v("名称")]), _vm._v(" "), _c('div', {
    staticClass: "col-sm-10"
  }, [_c('input', {
    directives: [{
      name: "model",
      rawName: "v-model",
      value: (_vm.node.name),
      expression: "node.name"
    }],
    staticClass: "form-control",
    attrs: {
      "type": "text",
      "id": "name",
      "name": "name",
      "placeholder": "请输入名称",
      "disabled": typeof _vm.node.id != 'undefined'
    },
    domProps: {
      "value": _vm._s(_vm.node.name)
    },
    on: {
      "input": function($event) {
        if ($event.target.composing) { return; }
        _vm.node.name = $event.target.value
      }
    }
  }), _vm._v(" "), _vm._m(0)])]), _vm._v(" "), _c('div', {
    staticClass: "form-group"
  }, [_c('label', {
    staticClass: "col-sm-2 control-label",
    attrs: {
      "for": "name"
    }
  }, [_vm._v("父级")]), _vm._v(" "), _c('div', {
    staticClass: "col-sm-10"
  }, [_c('input', {
    directives: [{
      name: "model",
      rawName: "v-model",
      value: (_vm.node.parent.id),
      expression: "node.parent.id"
    }],
    attrs: {
      "type": "hidden",
      "id": "pid",
      "name": "pid"
    },
    domProps: {
      "value": _vm._s(_vm.node.parent.id)
    },
    on: {
      "input": function($event) {
        if ($event.target.composing) { return; }
        _vm.node.parent.id = $event.target.value
      }
    }
  }), _vm._v(" "), _c('p', {
    staticClass: "form-control-static",
    attrs: {
      "id": "p-title"
    }
  }, [_vm._v(_vm._s(_vm.node.parent.title))])])]), _vm._v(" "), _c('div', {
    staticClass: "form-group"
  }, [_c('label', {
    staticClass: "col-sm-2 control-label",
    attrs: {
      "for": "title"
    }
  }, [_vm._v("标题")]), _vm._v(" "), _c('div', {
    staticClass: "col-sm-10"
  }, [_c('input', {
    directives: [{
      name: "model",
      rawName: "v-model",
      value: (_vm.node.title),
      expression: "node.title"
    }],
    staticClass: "form-control",
    attrs: {
      "type": "text",
      "id": "title",
      "name": "title",
      "placeholder": "请输入标题"
    },
    domProps: {
      "value": _vm._s(_vm.node.title)
    },
    on: {
      "input": function($event) {
        if ($event.target.composing) { return; }
        _vm.node.title = $event.target.value
      }
    }
  }), _vm._v(" "), _vm._m(1)])]), _vm._v(" "), _c('keep-alive', [_c(_vm.catalogExtra, {
    tag: "component",
    attrs: {
      "node": _vm.node
    }
  })], 1), _vm._v(" "), _c('div', {
    staticClass: "form-group"
  }, [_c('div', {
    staticClass: "col-sm-10 col-sm-offset-2 text-center"
  }, [_c('button', {
    staticClass: "btn btn-success",
    attrs: {
      "type": "submit",
      "disabled": typeof _vm.node.parent.id == 'undefined'
    }
  }, [_vm._v("保存")])])])], 1)
},staticRenderFns: [function (){var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;
  return _c('span', {
    staticClass: "help-block"
  }, [_vm._v("对内名称，同层级下唯一，只允许英文、下划线、数字，"), _c('b', [_vm._v("设置后无法修改")])])
},function (){var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;
  return _c('span', {
    staticClass: "help-block"
  }, [_vm._v("对外显示的标题，"), _c('b')])
}]}
module.exports.render._withStripped = true
if (false) {
  module.hot.accept()
  if (module.hot.data) {
     require("vue-loader/node_modules/vue-hot-reload-api").rerender("data-v-1e1a2110", module.exports)
  }
}

/***/ }),
/* 4 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
Object.defineProperty(__webpack_exports__, "__esModule", { value: true });
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//

/* harmony default export */ __webpack_exports__["default"] = {
	props: ['csrf', 'urlPrefix'],
	data: function data() {
		return {
			action: '',
			method: '',
			catalogExtra: '',
			node: {
				parent: {},
				extra: {}
			}
		};
	},

	methods: {
		get: function get(id) {
			var _this = this;

			return LP.get(this.urlPrefix + '/' + id + '?of=json').done(function (json) {
				if (typeof json.data != 'undefined' && !json.data.extra) json.data.extra = {};
				var parents = [json.data.name];
				var _iteratorNormalCompletion = true;
				var _didIteratorError = false;
				var _iteratorError = undefined;

				try {
					for (var _iterator = json.data.parents[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {
						var v = _step.value;

						parents.push(v.name);
					}
				} catch (err) {
					_didIteratorError = true;
					_iteratorError = err;
				} finally {
					try {
						if (!_iteratorNormalCompletion && _iterator.return) {
							_iterator.return();
						}
					} finally {
						if (_didIteratorError) {
							throw _iteratorError;
						}
					}
				}

				parents.reverse();
				_this.extraTemplate(parents);
			});
		},
		extraTemplate: function extraTemplate(parents) {
			var components = ['catalog-extra'];
			var _iteratorNormalCompletion2 = true;
			var _didIteratorError2 = false;
			var _iteratorError2 = undefined;

			try {
				for (var _iterator2 = parents[Symbol.iterator](), _step2; !(_iteratorNormalCompletion2 = (_step2 = _iterator2.next()).done); _iteratorNormalCompletion2 = true) {
					var v = _step2.value;

					components.push(components[components.length - 1] + '-' + v);
				}
			} catch (err) {
				_didIteratorError2 = true;
				_iteratorError2 = err;
			} finally {
				try {
					if (!_iteratorNormalCompletion2 && _iterator2.return) {
						_iterator2.return();
					}
				} finally {
					if (_didIteratorError2) {
						throw _iteratorError2;
					}
				}
			}

			components.reverse();
			var _iteratorNormalCompletion3 = true;
			var _didIteratorError3 = false;
			var _iteratorError3 = undefined;

			try {
				for (var _iterator3 = components[Symbol.iterator](), _step3; !(_iteratorNormalCompletion3 = (_step3 = _iterator3.next()).done); _iteratorNormalCompletion3 = true) {
					var _v = _step3.value;

					if (typeof Vue.options.components[_v] != 'undefined') {
						this.catalogExtra = _v;
						return;
					}
				}
			} catch (err) {
				_didIteratorError3 = true;
				_iteratorError3 = err;
			} finally {
				try {
					if (!_iteratorNormalCompletion3 && _iterator3.return) {
						_iterator3.return();
					}
				} finally {
					if (_didIteratorError3) {
						throw _iteratorError3;
					}
				}
			}

			this.catalogExtra = '';
		},
		create: function create(pid) {
			var _this2 = this;

			this.get(pid).done(function (response) {
				_this2.action = _this2.urlPrefix;
				_this2.method = 'POST';
				_this2.node = {
					parent: response.data,
					extra: {}
				};
			});
		},
		edit: function edit(id) {
			var _this3 = this;

			this.get(id).done(function (response) {
				_this3.action = _this3.urlPrefix + '/' + id;
				_this3.method = 'PUT';
				_this3.node = response.data;
			});
		}
	}
};

/***/ }),
/* 5 */
/***/ (function(module, exports, __webpack_require__) {

module.exports = __webpack_require__(0);


/***/ }),
/* 6 */
/***/ (function(module, exports, __webpack_require__) {

var Component = __webpack_require__(2)(
  /* script */
  __webpack_require__(8),
  /* template */
  __webpack_require__(7),
  /* scopeId */
  null,
  /* cssModules */
  null
)
Component.options.__file = "d:\\Website\\project\\l++\\static\\js\\catalog\\vue\\catalog-extra-site.vue"
if (Component.esModule && Object.keys(Component.esModule).some(function (key) {return key !== "default" && key !== "__esModule"})) {console.error("named exports are not supported in *.vue files.")}
if (Component.options.functional) {console.error("[vue-loader] catalog-extra-site.vue: functional components are not supported with templates, they should use render functions.")}

/* hot reload */
if (false) {(function () {
  var hotAPI = require("vue-loader/node_modules/vue-hot-reload-api")
  hotAPI.install(require("vue"), false)
  if (!hotAPI.compatible) return
  module.hot.accept()
  if (!module.hot.data) {
    hotAPI.createRecord("data-v-e390b7e6", Component.options)
  } else {
    hotAPI.reload("data-v-e390b7e6", Component.options)
  }
})()}

module.exports = Component.exports


/***/ }),
/* 7 */
/***/ (function(module, exports, __webpack_require__) {

module.exports={render:function (){var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;
  return _c('div', {
    staticClass: "form-group"
  }, [_c('label', {
    staticClass: "col-sm-2 control-label",
    attrs: {
      "for": "extra-description"
    }
  }, [_vm._v("栏目介绍")]), _vm._v(" "), _c('div', {
    staticClass: "col-sm-10"
  }, [_c('textarea', {
    directives: [{
      name: "model",
      rawName: "v-model",
      value: (_vm.node.extra.description),
      expression: "node.extra.description"
    }],
    staticClass: "form-control",
    attrs: {
      "id": "extra-description",
      "name": "extra[description]",
      "placeholder": "请输入栏目介绍",
      "rows": "10"
    },
    domProps: {
      "value": _vm._s(_vm.node.extra.description)
    },
    on: {
      "input": function($event) {
        if ($event.target.composing) { return; }
        _vm.node.extra.description = $event.target.value
      }
    }
  }), _vm._v(" "), _vm._m(0)])])
},staticRenderFns: [function (){var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;
  return _c('span', {
    staticClass: "help-block"
  }, [_vm._v("选填，本栏目的文字介绍"), _c('b')])
}]}
module.exports.render._withStripped = true
if (false) {
  module.hot.accept()
  if (module.hot.data) {
     require("vue-loader/node_modules/vue-hot-reload-api").rerender("data-v-e390b7e6", module.exports)
  }
}

/***/ }),
/* 8 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
Object.defineProperty(__webpack_exports__, "__esModule", { value: true });
//
//
//
//
//
//
//
//
//
//

/* harmony default export */ __webpack_exports__["default"] = {
	props: ['node'],
	data: function data() {
		return {};
	}
};

/***/ })
/******/ ]);